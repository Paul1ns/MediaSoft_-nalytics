1)Вывести покупателей с количеством осуществленных покупок

SELECT p.id_пок, p.имя, p.фамилия, COUNT(o.id) AS количество_покупок
FROM Покупатель p
LEFT JOIN Покупки o ON p.id_пок = o.id_пок
GROUP BY p.id_пок, p.имя, p.фамилия;


2)Общую стоимость товаров для каждого покупателя и отсортировать результат в порядке убывания

SELECT p.id_пок, p.имя, p.фамилия, SUM(t.стоимость) AS общая_стоимость
FROM Покупатель p
JOIN Покупки o ON p.id_пок = o.id_пок
JOIN Товары t ON o.id_тов = t.id_тов
GROUP BY p.id_пок, p.имя, p.фамилия
ORDER BY общая_стоимость DESC;


3)Получить покупателей, купивших только один товар

SELECT p.id_пок, p.имя, p.фамилия
FROM Покупатель p
JOIN Покупки o ON p.id_пок = o.id_пок
GROUP BY p.id_пок, p.имя, p.фамилия
HAVING COUNT(o.id) = 1;